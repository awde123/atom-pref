function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

var _path = require('path');

// eslint-disable-next-line import/no-extraneous-dependencies

var _jasmineFix = require('jasmine-fix');

// NOTE: If using fit you must add it to the list above!

'use babel';

var fixturePath = (0, _path.join)(__dirname, 'fixtures');
var goodPath = (0, _path.join)(fixturePath, 'good.py');
var badPath = (0, _path.join)(fixturePath, 'bad.py');
var errwarnPath = (0, _path.join)(fixturePath, 'errwarn.py');
var builtinsPath = (0, _path.join)(fixturePath, 'builtins.py');

describe('The flake8 provider for Linter', function () {
  var lint = require('../lib/main.js').provideLinter().lint;

  (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
    // Info about this beforeEach() implementation:
    // https://github.com/AtomLinter/Meta/issues/15
    var activationPromise = atom.packages.activatePackage('linter-flake8');

    yield atom.packages.activatePackage('language-python');
    yield atom.workspace.open(goodPath);

    atom.packages.triggerDeferredActivationHooks();
    yield activationPromise;
  }));

  (0, _jasmineFix.it)('should be in the packages list', function () {
    return expect(atom.packages.isPackageLoaded('linter-flake8')).toBe(true);
  });

  (0, _jasmineFix.it)('should be an active package', function () {
    return expect(atom.packages.isPackageActive('linter-flake8')).toBe(true);
  });

  describe('checks bad.py and', function () {
    var editor = null;
    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      editor = yield atom.workspace.open(badPath);
    }));

    (0, _jasmineFix.it)('finds at least one message', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages.length).toBeGreaterThan(0);
    }));

    (0, _jasmineFix.it)('verifies that message', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Warning');
      expect(messages[0].html).not.toBeDefined();
      expect(messages[0].text).toBe('F821 — undefined name \'asfd\'');
      expect(messages[0].filePath).toBe(badPath);
      expect(messages[0].range).toEqual([[0, 0], [0, 4]]);
    }));

    (0, _jasmineFix.it)('checks that the message is an error if flakeErrors is set', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.flakeErrors', true);
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Error');
    }));
  });

  describe('checks errwarn.py and', function () {
    var editor = null;

    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      editor = yield atom.workspace.open(errwarnPath);
    }));

    (0, _jasmineFix.it)('finds at least one message', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages.length).toBeGreaterThan(0);
    }));

    (0, _jasmineFix.it)('finds the message is a warning if pycodestyleErrorsToWarnings is set', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.pycodestyleErrorsToWarnings', true);
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Warning');
    }));

    (0, _jasmineFix.it)("finds the message is an error if pycodestyleErrorsToWarnings isn't set", _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.pycodestyleErrorsToWarnings', false);
      var messages = yield lint(editor);
      expect(messages[0].type).toBe('Error');
    }));
  });

  (0, _jasmineFix.it)('finds nothing wrong with a valid file', _asyncToGenerator(function* () {
    var editor = yield atom.workspace.open(goodPath);
    var messages = yield lint(editor);
    expect(messages.length).toBe(0);
  }));

  describe('executable path', function () {
    var helpers = require('atom-linter');

    var editor = null;
    var realExec = helpers.exec;
    var execParams = [];
    function fakeExec() {
      for (var _len = arguments.length, parameters = Array(_len), _key = 0; _key < _len; _key++) {
        parameters[_key] = arguments[_key];
      }

      execParams.push(parameters);
      return Promise.resolve('');
    }

    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      atom.project.addPath(fixturePath);

      Object.defineProperty(helpers, 'exec', {
        enumerable: true,
        value: fakeExec
      });

      editor = yield atom.workspace.open(badPath);
    }));

    afterEach(function () {
      Object.defineProperty(helpers, 'exec', {
        enumerable: true,
        value: realExec
      });
    });

    (0, _jasmineFix.it)('finds executable relative to project', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.executablePath', (0, _path.join)('$PROJECT', 'flake8'));
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8'));
    }));

    (0, _jasmineFix.it)('finds executable relative to projects', _asyncToGenerator(function* () {
      var paths = [(0, _path.join)('$project', 'null'), (0, _path.join)('$pRoJeCt', 'flake1'), (0, _path.join)('$PrOjEcT', 'flake2'), (0, _path.join)('$PROJECT', 'flake8')].join(';');
      atom.config.set('linter-flake8.executablePath', paths);
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8'));
    }));

    (0, _jasmineFix.it)('finds executable using project name', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.executablePath', (0, _path.join)('$PROJECT_NAME', 'flake8'));
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)('fixtures', 'flake8'));
    }));

    (0, _jasmineFix.it)('finds executable using project names', _asyncToGenerator(function* () {
      var paths = [(0, _path.join)('$project_name', 'null'), (0, _path.join)('$pRoJeCt_NaMe', 'flake1'), (0, _path.join)('$PrOjEcT_nAmE', 'flake2'), (0, _path.join)('$PROJECT_NAME', 'flake8')].join(';');
      var correct = [(0, _path.join)('fixtures', 'null'), (0, _path.join)('fixtures', 'flake1'), (0, _path.join)('fixtures', 'flake2'), (0, _path.join)('fixtures', 'flake8')].join(';');
      atom.config.set('linter-flake8.executablePath', paths);
      yield lint(editor);
      expect(execParams.pop()[0]).toBe(correct);
    }));

    (0, _jasmineFix.it)('normalizes executable path', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.executablePath', (0, _path.join)(fixturePath, '..', 'fixtures', 'flake8'));
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8'));
    }));

    (0, _jasmineFix.it)('finds backup executable', _asyncToGenerator(function* () {
      var flakeNotFound = (0, _path.join)('$PROJECT', 'flake8_notfound');
      var flakeBackup = (0, _path.join)(fixturePath, 'flake8_backup');
      atom.config.set('linter-flake8.executablePath', flakeNotFound + ';' + flakeBackup);
      yield lint(editor);
      expect(execParams.pop()[0]).toBe((0, _path.join)(fixturePath, 'flake8_backup'));
    }));
  });

  describe('works with defining builtins', function () {
    var editor = undefined;

    (0, _jasmineFix.beforeEach)(_asyncToGenerator(function* () {
      editor = yield atom.workspace.open(builtinsPath);
    }));

    (0, _jasmineFix.it)('shows all warnings when the setting is blank', _asyncToGenerator(function* () {
      var messages = yield lint(editor);
      expect(messages.length).toBe(2);

      expect(messages[0].type).toBe('Warning');
      expect(messages[0].html).not.toBeDefined();
      expect(messages[0].text).toBe('F821 — undefined name \'bar\'');
      expect(messages[0].filePath).toBe(builtinsPath);
      expect(messages[0].range).toEqual([[0, 6], [0, 9]]);

      expect(messages[1].type).toBe('Warning');
      expect(messages[1].html).not.toBeDefined();
      expect(messages[1].text).toBe('F821 — undefined name \'foo_bar\'');
      expect(messages[1].filePath).toBe(builtinsPath);
      expect(messages[1].range).toEqual([[1, 9], [1, 16]]);
    }));

    (0, _jasmineFix.it)('works with a single builtin', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.builtins', ['bar']);
      var messages = yield lint(editor);
      expect(messages.length).toBe(1);

      expect(messages[0].type).toBe('Warning');
      expect(messages[0].html).not.toBeDefined();
      expect(messages[0].text).toBe('F821 — undefined name \'foo_bar\'');
      expect(messages[0].filePath).toBe(builtinsPath);
      expect(messages[0].range).toEqual([[1, 9], [1, 16]]);
    }));

    (0, _jasmineFix.it)('works with multiple builtins', _asyncToGenerator(function* () {
      atom.config.set('linter-flake8.builtins', ['bar', 'foo_bar']);
      var messages = yield lint(editor);
      expect(messages.length).toBe(0);
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL3VnYy8uYXRvbS9wYWNrYWdlcy9saW50ZXItZmxha2U4L3NwZWMvbGludGVyLWZsYWtlOC1zcGVjLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O29CQUVxQixNQUFNOzs7OzBCQUVJLGFBQWE7Ozs7QUFKNUMsV0FBVyxDQUFDOztBQU9aLElBQU0sV0FBVyxHQUFHLGdCQUFLLFNBQVMsRUFBRSxVQUFVLENBQUMsQ0FBQztBQUNoRCxJQUFNLFFBQVEsR0FBRyxnQkFBSyxXQUFXLEVBQUUsU0FBUyxDQUFDLENBQUM7QUFDOUMsSUFBTSxPQUFPLEdBQUcsZ0JBQUssV0FBVyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBQzVDLElBQU0sV0FBVyxHQUFHLGdCQUFLLFdBQVcsRUFBRSxZQUFZLENBQUMsQ0FBQztBQUNwRCxJQUFNLFlBQVksR0FBRyxnQkFBSyxXQUFXLEVBQUUsYUFBYSxDQUFDLENBQUM7O0FBRXRELFFBQVEsQ0FBQyxnQ0FBZ0MsRUFBRSxZQUFNO0FBQy9DLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDLElBQUksQ0FBQzs7QUFFNUQsZ0RBQVcsYUFBWTs7O0FBR3JCLFFBQU0saUJBQWlCLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLENBQUM7O0FBRXpFLFVBQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUN2RCxVQUFNLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDOztBQUVwQyxRQUFJLENBQUMsUUFBUSxDQUFDLDhCQUE4QixFQUFFLENBQUM7QUFDL0MsVUFBTSxpQkFBaUIsQ0FBQztHQUN6QixFQUFDLENBQUM7O0FBRUgsc0JBQUcsZ0NBQWdDLEVBQUU7V0FDbkMsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxDQUFD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QyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUN0RCxFQUFDLENBQUM7O0FBRUgsd0JBQUcsOEJBQThCLG9CQUFFLGFBQVk7QUFDN0MsVUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLEVBQUUsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztBQUM5RCxVQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUNwQyxZQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUNqQyxFQUFDLENBQUM7R0FDSixDQUFDLENBQUM7Q0FDSixDQUFDLENBQUMiLCJmaWxlIjoiL2hvbWUvdWdjLy5hdG9tL3BhY2thZ2VzL2xpbnRlci1mbGFrZTgvc3BlYy9saW50ZXItZmxha2U4LXNwZWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcblxuaW1wb3J0IHsgam9pbiB9IGZyb20gJ3BhdGgnO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1leHRyYW5lb3VzLWRlcGVuZGVuY2llc1xuaW1wb3J0IHsgYmVmb3JlRWFjaCwgaXQgfSBmcm9tICdqYXNtaW5lLWZpeCc7XG4vLyBOT1RFOiBJZiB1c2luZyBmaXQgeW91IG11c3QgYWRkIGl0IHRvIHRoZSBsaXN0IGFib3ZlIVxuXG5jb25zdCBmaXh0dXJlUGF0aCA9IGpvaW4oX19kaXJuYW1lLCAnZml4dHVyZXMnKTtcbmNvbnN0IGdvb2RQYXRoID0gam9pbihmaXh0dXJlUGF0aCwgJ2dvb2QucHknKTtcbmNvbnN0IGJhZFBhdGggPSBqb2luKGZpeHR1cmVQYXRoLCAnYmFkLnB5Jyk7XG5jb25zdCBlcnJ3YXJuUGF0aCA9IGpvaW4oZml4dHVyZVBhdGgsICdlcnJ3YXJuLnB5Jyk7XG5jb25zdCBidWlsdGluc1BhdGggPSBqb2luKGZpeHR1cmVQYXRoLCAnYnVpbHRpbnMucHknKTtcblxuZGVzY3JpYmUoJ1RoZSBmbGFrZTggcHJvdmlkZXIgZm9yIExpbnRlcicsICgpID0+IHtcbiAgY29uc3QgbGludCA9IHJlcXVpcmUoJy4uL2xpYi9tYWluLmpzJykucHJvdmlkZUxpbnRlcigpLmxpbnQ7XG5cbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgLy8gSW5mbyBhYm91dCB0aGlzIGJlZm9yZUVhY2goKSBpbXBsZW1lbnRhdGlvbjpcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vQXRvbUxpbnRlci9NZXRhL2lzc3Vlcy8xNVxuICAgIGNvbnN0IGFjdGl2YXRpb25Qcm9taXNlID0gYXRvbS5wYWNrYWdlcy5hY3RpdmF0ZVBhY2thZ2UoJ2xpbnRlci1mbGFrZTgnKTtcblxuICAgIGF3YWl0IGF0b20ucGFja2FnZXMuYWN0aXZhdGVQYWNrYWdlKCdsYW5ndWFnZS1weXRob24nKTtcbiAgICBhd2FpdCBhdG9tLndvcmtzcGFjZS5vcGVuKGdvb2RQYXRoKTtcblxuICAgIGF0b20ucGFja2FnZXMudHJpZ2dlckRlZmVycmVkQWN0aXZhdGlvbkhvb2tzKCk7XG4gICAgYXdhaXQgYWN0aXZhdGlvblByb21pc2U7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgYmUgaW4gdGhlIHBhY2thZ2VzIGxpc3QnLCAoKSA9PlxuICAgIGV4cGVjdChhdG9tLnBhY2thZ2VzLmlzUGFja2FnZUxvYWRlZCgnbGludGVyLWZsYWtlOCcpKS50b0JlKHRydWUpLFxuICApO1xuXG4gIGl0KCdzaG91bGQgYmUgYW4gYWN0aXZlIHBhY2thZ2UnLCAoKSA9PlxuICAgIGV4cGVjdChhdG9tLnBhY2thZ2VzLmlzUGFja2FnZUFjdGl2ZSgnbGludGVyLWZsYWtlOCcpKS50b0JlKHRydWUpLFxuICApO1xuXG4gIGRlc2NyaWJlKCdjaGVja3MgYmFkLnB5IGFuZCcsICgpID0+IHtcbiAgICBsZXQgZWRpdG9yID0gbnVsbDtcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGVkaXRvciA9IGF3YWl0IGF0b20ud29ya3NwYWNlLm9wZW4oYmFkUGF0aCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgYXQgbGVhc3Qgb25lIG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCd2ZXJpZmllcyB0aGF0IG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS50eXBlKS50b0JlKCdXYXJuaW5nJyk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0uaHRtbCkubm90LnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0udGV4dCkudG9CZSgnRjgyMSDigJQgdW5kZWZpbmVkIG5hbWUgXFwnYXNmZFxcJycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLmZpbGVQYXRoKS50b0JlKGJhZFBhdGgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnJhbmdlKS50b0VxdWFsKFtbMCwgMF0sIFswLCA0XV0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2NoZWNrcyB0aGF0IHRoZSBtZXNzYWdlIGlzIGFuIGVycm9yIGlmIGZsYWtlRXJyb3JzIGlzIHNldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5mbGFrZUVycm9ycycsIHRydWUpO1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0udHlwZSkudG9CZSgnRXJyb3InKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NoZWNrcyBlcnJ3YXJuLnB5IGFuZCcsICgpID0+IHtcbiAgICBsZXQgZWRpdG9yID0gbnVsbDtcblxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgICAgZWRpdG9yID0gYXdhaXQgYXRvbS53b3Jrc3BhY2Uub3BlbihlcnJ3YXJuUGF0aCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgYXQgbGVhc3Qgb25lIG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaW5kcyB0aGUgbWVzc2FnZSBpcyBhIHdhcm5pbmcgaWYgcHljb2Rlc3R5bGVFcnJvcnNUb1dhcm5pbmdzIGlzIHNldCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5weWNvZGVzdHlsZUVycm9yc1RvV2FybmluZ3MnLCB0cnVlKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnR5cGUpLnRvQmUoJ1dhcm5pbmcnKTtcbiAgICB9KTtcblxuICAgIGl0KFwiZmluZHMgdGhlIG1lc3NhZ2UgaXMgYW4gZXJyb3IgaWYgcHljb2Rlc3R5bGVFcnJvcnNUb1dhcm5pbmdzIGlzbid0IHNldFwiLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTgucHljb2Rlc3R5bGVFcnJvcnNUb1dhcm5pbmdzJywgZmFsc2UpO1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0udHlwZSkudG9CZSgnRXJyb3InKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgaXQoJ2ZpbmRzIG5vdGhpbmcgd3Jvbmcgd2l0aCBhIHZhbGlkIGZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgZWRpdG9yID0gYXdhaXQgYXRvbS53b3Jrc3BhY2Uub3Blbihnb29kUGF0aCk7XG4gICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgZXhwZWN0KG1lc3NhZ2VzLmxlbmd0aCkudG9CZSgwKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2V4ZWN1dGFibGUgcGF0aCcsICgpID0+IHtcbiAgICBjb25zdCBoZWxwZXJzID0gcmVxdWlyZSgnYXRvbS1saW50ZXInKTtcblxuICAgIGxldCBlZGl0b3IgPSBudWxsO1xuICAgIGNvbnN0IHJlYWxFeGVjID0gaGVscGVycy5leGVjO1xuICAgIGNvbnN0IGV4ZWNQYXJhbXMgPSBbXTtcbiAgICBmdW5jdGlvbiBmYWtlRXhlYyguLi5wYXJhbWV0ZXJzKSB7XG4gICAgICBleGVjUGFyYW1zLnB1c2gocGFyYW1ldGVycyk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCcnKTtcbiAgICB9XG5cbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcbiAgICAgIGF0b20ucHJvamVjdC5hZGRQYXRoKGZpeHR1cmVQYXRoKTtcblxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGhlbHBlcnMsICdleGVjJywge1xuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogZmFrZUV4ZWMsXG4gICAgICB9KTtcblxuICAgICAgZWRpdG9yID0gYXdhaXQgYXRvbS53b3Jrc3BhY2Uub3BlbihiYWRQYXRoKTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaGVscGVycywgJ2V4ZWMnLCB7XG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiByZWFsRXhlYyxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ2ZpbmRzIGV4ZWN1dGFibGUgcmVsYXRpdmUgdG8gcHJvamVjdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5leGVjdXRhYmxlUGF0aCcsIGpvaW4oJyRQUk9KRUNUJywgJ2ZsYWtlOCcpKTtcbiAgICAgIGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChleGVjUGFyYW1zLnBvcCgpWzBdKS50b0JlKGpvaW4oZml4dHVyZVBhdGgsICdmbGFrZTgnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgZXhlY3V0YWJsZSByZWxhdGl2ZSB0byBwcm9qZWN0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBhdGhzID0gW1xuICAgICAgICBqb2luKCckcHJvamVjdCcsICdudWxsJyksXG4gICAgICAgIGpvaW4oJyRwUm9KZUN0JywgJ2ZsYWtlMScpLFxuICAgICAgICBqb2luKCckUHJPakVjVCcsICdmbGFrZTInKSxcbiAgICAgICAgam9pbignJFBST0pFQ1QnLCAnZmxha2U4JyksXG4gICAgICBdLmpvaW4oJzsnKTtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5leGVjdXRhYmxlUGF0aCcsIHBhdGhzKTtcbiAgICAgIGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChleGVjUGFyYW1zLnBvcCgpWzBdKS50b0JlKGpvaW4oZml4dHVyZVBhdGgsICdmbGFrZTgnKSk7XG4gICAgfSk7XG5cbiAgICBpdCgnZmluZHMgZXhlY3V0YWJsZSB1c2luZyBwcm9qZWN0IG5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLCBqb2luKCckUFJPSkVDVF9OQU1FJywgJ2ZsYWtlOCcpKTtcbiAgICAgIGF3YWl0IGxpbnQoZWRpdG9yKTtcbiAgICAgIGV4cGVjdChleGVjUGFyYW1zLnBvcCgpWzBdKS50b0JlKGpvaW4oJ2ZpeHR1cmVzJywgJ2ZsYWtlOCcpKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaW5kcyBleGVjdXRhYmxlIHVzaW5nIHByb2plY3QgbmFtZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXRocyA9IFtcbiAgICAgICAgam9pbignJHByb2plY3RfbmFtZScsICdudWxsJyksXG4gICAgICAgIGpvaW4oJyRwUm9KZUN0X05hTWUnLCAnZmxha2UxJyksXG4gICAgICAgIGpvaW4oJyRQck9qRWNUX25BbUUnLCAnZmxha2UyJyksXG4gICAgICAgIGpvaW4oJyRQUk9KRUNUX05BTUUnLCAnZmxha2U4JyksXG4gICAgICBdLmpvaW4oJzsnKTtcbiAgICAgIGNvbnN0IGNvcnJlY3QgPSBbXG4gICAgICAgIGpvaW4oJ2ZpeHR1cmVzJywgJ251bGwnKSxcbiAgICAgICAgam9pbignZml4dHVyZXMnLCAnZmxha2UxJyksXG4gICAgICAgIGpvaW4oJ2ZpeHR1cmVzJywgJ2ZsYWtlMicpLFxuICAgICAgICBqb2luKCdmaXh0dXJlcycsICdmbGFrZTgnKSxcbiAgICAgIF0uam9pbignOycpO1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmV4ZWN1dGFibGVQYXRoJywgcGF0aHMpO1xuICAgICAgYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUoY29ycmVjdCk7XG4gICAgfSk7XG5cbiAgICBpdCgnbm9ybWFsaXplcyBleGVjdXRhYmxlIHBhdGgnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhdG9tLmNvbmZpZy5zZXQoJ2xpbnRlci1mbGFrZTguZXhlY3V0YWJsZVBhdGgnLFxuICAgICAgICBqb2luKGZpeHR1cmVQYXRoLCAnLi4nLCAnZml4dHVyZXMnLCAnZmxha2U4JyksXG4gICAgICApO1xuICAgICAgYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KGV4ZWNQYXJhbXMucG9wKClbMF0pLnRvQmUoam9pbihmaXh0dXJlUGF0aCwgJ2ZsYWtlOCcpKTtcbiAgICB9KTtcblxuICAgIGl0KCdmaW5kcyBiYWNrdXAgZXhlY3V0YWJsZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZsYWtlTm90Rm91bmQgPSBqb2luKCckUFJPSkVDVCcsICdmbGFrZThfbm90Zm91bmQnKTtcbiAgICAgIGNvbnN0IGZsYWtlQmFja3VwID0gam9pbihmaXh0dXJlUGF0aCwgJ2ZsYWtlOF9iYWNrdXAnKTtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5leGVjdXRhYmxlUGF0aCcsXG4gICAgICAgIGAke2ZsYWtlTm90Rm91bmR9OyR7Zmxha2VCYWNrdXB9YCxcbiAgICAgICk7XG4gICAgICBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QoZXhlY1BhcmFtcy5wb3AoKVswXSkudG9CZShqb2luKGZpeHR1cmVQYXRoLCAnZmxha2U4X2JhY2t1cCcpKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3dvcmtzIHdpdGggZGVmaW5pbmcgYnVpbHRpbnMnLCAoKSA9PiB7XG4gICAgbGV0IGVkaXRvcjtcblxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgICAgZWRpdG9yID0gYXdhaXQgYXRvbS53b3Jrc3BhY2Uub3BlbihidWlsdGluc1BhdGgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3dzIGFsbCB3YXJuaW5ncyB3aGVuIHRoZSBzZXR0aW5nIGlzIGJsYW5rJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXMubGVuZ3RoKS50b0JlKDIpO1xuXG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0udHlwZSkudG9CZSgnV2FybmluZycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLmh0bWwpLm5vdC50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnRleHQpLnRvQmUoJ0Y4MjEg4oCUIHVuZGVmaW5lZCBuYW1lIFxcJ2JhclxcJycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLmZpbGVQYXRoKS50b0JlKGJ1aWx0aW5zUGF0aCk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0ucmFuZ2UpLnRvRXF1YWwoW1swLCA2XSwgWzAsIDldXSk7XG5cbiAgICAgIGV4cGVjdChtZXNzYWdlc1sxXS50eXBlKS50b0JlKCdXYXJuaW5nJyk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMV0uaHRtbCkubm90LnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMV0udGV4dCkudG9CZSgnRjgyMSDigJQgdW5kZWZpbmVkIG5hbWUgXFwnZm9vX2JhclxcJycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzFdLmZpbGVQYXRoKS50b0JlKGJ1aWx0aW5zUGF0aCk7XG4gICAgICBleHBlY3QobWVzc2FnZXNbMV0ucmFuZ2UpLnRvRXF1YWwoW1sxLCA5XSwgWzEsIDE2XV0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3dvcmtzIHdpdGggYSBzaW5nbGUgYnVpbHRpbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGF0b20uY29uZmlnLnNldCgnbGludGVyLWZsYWtlOC5idWlsdGlucycsIFsnYmFyJ10pO1xuICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBsaW50KGVkaXRvcik7XG4gICAgICBleHBlY3QobWVzc2FnZXMubGVuZ3RoKS50b0JlKDEpO1xuXG4gICAgICBleHBlY3QobWVzc2FnZXNbMF0udHlwZSkudG9CZSgnV2FybmluZycpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLmh0bWwpLm5vdC50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnRleHQpLnRvQmUoJ0Y4MjEg4oCUIHVuZGVmaW5lZCBuYW1lIFxcJ2Zvb19iYXJcXCcnKTtcbiAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5maWxlUGF0aCkudG9CZShidWlsdGluc1BhdGgpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnJhbmdlKS50b0VxdWFsKFtbMSwgOV0sIFsxLCAxNl1dKTtcbiAgICB9KTtcblxuICAgIGl0KCd3b3JrcyB3aXRoIG11bHRpcGxlIGJ1aWx0aW5zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXRvbS5jb25maWcuc2V0KCdsaW50ZXItZmxha2U4LmJ1aWx0aW5zJywgWydiYXInLCAnZm9vX2JhciddKTtcbiAgICAgIGNvbnN0IG1lc3NhZ2VzID0gYXdhaXQgbGludChlZGl0b3IpO1xuICAgICAgZXhwZWN0KG1lc3NhZ2VzLmxlbmd0aCkudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==